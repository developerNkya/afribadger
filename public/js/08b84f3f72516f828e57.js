(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{397:function(t,e,r){"use strict";e.a={getHappeningNow:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"user{full_name,username,profile_image,verification_status};discovery_item{:all}";return t.$get("/v1/discovery/now",{params:{fields:"post.page(".concat(e,").limit(").concat(r,").order(created_at,desc);").concat(o)}})},getItems:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t.$get("/v1/discovery/items",{params:{fields:e}})},getPopular:function(t){return t.$get("/v1/discovery/items").then((function(t){var e=t.popular;return void 0===e?[]:e}))},getTravelTips:function(t){return t.$get("/v1/discovery/items").then((function(t){var e=t.travel_tip;return void 0===e?[]:e}))},getJourneys:function(t){return t.$get("/v1/discovery/items").then((function(t){var e=t.journey;return void 0===e?[]:e}))},getArticle:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"discovery_item{:all}";return t.$get("/v1/discovery/items/".concat(e),{params:{fields:r}})},getUsers:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"discovery_item{:all};post{:default,community_group}";return t.$get("/v1/discovery/users",{params:{fields:e}}).then((function(t){return t.filter((function(t){var e=t.post,r=t.user;return e&&r}))}))},getNearby:function(t){return t.$get("/v1/users/self/nearby",{params:{"polygon[0][lat]":90,"polygon[0][lng]":-180,"polygon[1][lat]":90,"polygon[1][lng]":180,"polygon[2][lat]":-90,"polygon[2][lng]":180,"polygon[3][lat]":-90,"polygon[3][lng]":-180,fields:"user{id,full_name,username,email,profile_image,visible_location}"}})},getDocumentaries:function(t){return t.$get("/v1/discovery/documentaries")}}},413:function(t,e,r){"use strict";r(20),r(11),r(9),r(8),r(15);var o=r(6);r(53),r(146);function n(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function l(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?n(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):n(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var c={props:{zoom:{type:Number,default:void 0},center:{type:Array,default:function(){return[20,20]}},zoomPosition:{type:String,default:"bottomright"},scrollWheelZoom:{type:Boolean,default:!0},isLocked:{type:Boolean,default:!1},isRememberable:{type:Boolean,default:!1}},computed:{mapObject:function(){return this.$refs.map.mapObject},mapOptions:function(){return{maxZoom:20,zoomSnap:0,scrollWheelZoom:this.scrollWheelZoom,attributionControl:!1,zoomControl:!1}},tileLayer:function(){return["https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=","pk.eyJ1IjoiYmVuZ290dGxpZWItdG9wdGFsIiwiYSI6ImNqdXFzNDVsMjE1ODg0NHBpMXZ2dDR5MG4ifQ.X7NMaRCJ0sIC2lrMBgtcVg"].join("")},tileOptions:function(){return{maxNativeZoom:20,maxZoom:20}}},watch:{isLocked:function(t){t?(this.mapObject.touchZoom.disable(),this.mapObject.doubleClickZoom.disable(),this.mapObject.scrollWheelZoom.disable(),this.mapObject.boxZoom.disable(),this.mapObject.keyboard.disable(),this.mapObject.dragging.disable()):(this.mapObject.touchZoom.enable(),this.mapObject.doubleClickZoom.enable(),this.mapObject.scrollWheelZoom.enable(),this.mapObject.boxZoom.enable(),this.mapObject.keyboard.enable(),this.mapObject.dragging.enable())}},mounted:function(){var t=this;this.$nextTick((function(){t.calculateMinZoom(void 0===t.zoom),t.bindRememberable(),window.dispatchEvent(new Event("resize"))})),window.addEventListener("resize",this.calculateMinZoom),window.addEventListener("orientationchange",this.calculateMinZoom)},beforeDestroy:function(){window.removeEventListener("resize",this.calculateMinZoom),window.removeEventListener("orientationchange",this.calculateMinZoom)},methods:{bindRememberable:function(){var t=this;if(this.isRememberable){this.$route.query.zoom&&this.mapObject.setZoom(parseFloat(this.$route.query.zoom)),this.$route.query.lat&&this.$route.query.lng&&(console.log("test",[parseFloat(this.$route.query.lat),parseFloat(this.$route.query.lng)]),this.mapObject.panTo([parseFloat(this.$route.query.lat),parseFloat(this.$route.query.lng)]));var e=function(e){var r=e.target;t.$router.replace({query:l(l({},t.$route.query),{},{zoom:r.getZoom(),lat:r.getCenter().lat,lng:r.getCenter().lng})})};setTimeout((function(){t.mapObject.addEventListener("zoomend",e),t.mapObject.addEventListener("moveend",e)}),1e3)}},maxBounds:function(t){return[[-90,-(t?1/0:180)],[60,t?1/0:180]]},calculateMinZoom:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.mapObject.getBoundsZoom(this.maxBounds(!0),!0);t&&this.mapObject.setZoom(e)}}},m=r(0),component=Object(m.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"bg-blue-leaflet h-full w-full"},[r("div",{staticClass:"absolute invisible"},[t._t("icons")],2),t._v(" "),r("client-only",[r("l-map",{ref:"map",staticClass:"h-full w-full",attrs:{zoom:t.zoom,center:t.center,options:t.mapOptions,"world-copy-jump":!0}},[t.isLocked?t._e():r("l-control-zoom",{attrs:{position:t.zoomPosition}}),t._v(" "),r("l-tile-layer",{attrs:{url:t.tileLayer,options:t.tileOptions}}),t._v(" "),t._t("default")],2)],1)],1)}),[],!1,null,null,null);e.a=component.exports},432:function(t,e,r){"use strict";var o=r(0),component=Object(o.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"h-full overflow-hidden"},[this.$slots.submenu?e("div",{staticClass:"fixed z-floating left-0 right-0 pointer-events-none"},[this._t("submenu")],2):this._e(),this._v(" "),e("div",{staticClass:"relative h-full w-full"},[this._t("map")],2)])}),[],!1,null,null,null);e.a=component.exports},442:function(t,e,r){"use strict";var o=r(0),n=Object(o.a)({},(function(){var t=this.$createElement,e=this._self._c||t;return e("svg",this._g({attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 38 38"}},this.$listeners),[e("circle",{attrs:{cx:"728",cy:"2873",r:"16",fill:"var(--pink-primary)","fill-rule":"evenodd",stroke:"var(--white-hex)","stroke-width":"5",transform:"translate(-709 -2854)"}})])}),[],!1,null,null,null).exports,l=r(413),c={components:{CommonUserAvatar:r(17).a},props:{user:{type:Object,required:!0}}},m=Object(o.a)(c,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"relative w-full h-full"},[r("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 38 58"}},[r("defs",[r("path",{attrs:{id:"near-badge",d:"M4 2h30a2 2 0 0 1 2 2v37.99a2 2 0 0 1-.813 1.61L19.595 55.097a2 2 0 0 1-2.422-.036L2.765 43.755A2 2 0 0 1 2 42.182V4a2 2 0 0 1 2-2z"}}),t._v(" "),r("filter",{attrs:{id:"near-shadow",width:"120.6%",height:"112%",x:"-10.3%",y:"-4.6%",filterUnits:"objectBoundingBox"}},[r("feOffset",{attrs:{dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter"}}),t._v(" "),r("feGaussianBlur",{attrs:{in:"shadowOffsetOuter",result:"shadowBlurOuter",stdDeviation:"1"}}),t._v(" "),r("feColorMatrix",{attrs:{in:"shadowBlurOuter",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.204217657 0"}})],1),t._v(" "),r("linearGradient",{attrs:{id:"near-gradient",x1:"39.493%",x2:"61.61%",y1:"83.062%",y2:"16.099%"}},[r("stop",{attrs:{offset:"0%","stop-color":"var(--yellow)"}}),t._v(" "),r("stop",{attrs:{offset:"100%","stop-color":"var(--pink-primary)"}})],1)],1),t._v(" "),r("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[r("use",{attrs:{fill:"var(--black-hex)",filter:"url(#near-shadow)","xlink:href":"#near-badge"}}),t._v(" "),r("use",{attrs:{fill:"url(#near-gradient)","xlink:href":"#near-badge"}})])]),t._v(" "),r("div",{staticClass:"absolute top-10 left-half -ml-16"},[r("common-user-avatar",{staticClass:"h-30 w-30 border-2 border-white",attrs:{user:t.user}})],1)])}),[],!1,null,null,null).exports,d={components:{ShapeMapLocation:n,CommonMap:l.a,DiscoverNearPin:m},props:{items:{type:Array,required:!0},scrollWheelZoom:{type:Boolean,default:void 0},zoomPosition:{type:String,default:void 0}},computed:{userLocation:function(){return!1},clusterOptions:function(){var t=this;return{showCoverageOnHover:!1,spiderfyOnMaxZoom:!1,animate:!0,zoomToBoundsOnClick:!1,iconCreateFunction:function(e){return t.$leaflet.divIcon({html:t.generateClusterIcon(e.getChildCount()),iconSize:[0,0],iconAnchor:[0,0]})}}}},methods:{generateClusterIcon:function(t){return'\n                <div class="absolute w-45 bottom-0 transform -translate-x-half pointer-events-none">\n                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 38 58">\n                        <defs>\n                            <path id="cluster-badge" d="M4 2h30a2 2 0 0 1 2 2v37.99a2 2 0 0 1-.813 1.61L19.595 55.097a2 2 0 0 1-2.422-.036L2.765 43.755A2 2 0 0 1 2 42.182V4a2 2 0 0 1 2-2z" />\n                            <filter id="cluster-shadow" width="120.6%" height="112%" x="-10.3%" y="-4.6%" filterUnits="objectBoundingBox">\n                                <feOffset dy="1" in="SourceAlpha" result="shadowOffsetOuter" />\n                                <feGaussianBlur in="shadowOffsetOuter" result="shadowBlurOuter" stdDeviation="1" />\n                                <feColorMatrix in="shadowBlurOuter" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.204217657 0" />\n                            </filter>\n                            <linearGradient id="cluster-gradient" x1="39.493%" x2="61.61%" y1="83.062%" y2="16.099%">\n                                <stop offset="0%" stop-color="var(--yellow)" />\n                                <stop offset="100%" stop-color="var(--pink-primary)" />\n                            </linearGradient>\n                        </defs>\n                        <g fill="none" fill-rule="evenodd">\n                            <use fill="var(--black-hex)" filter="url(#cluster-shadow)" xlink:href="#cluster-badge" />\n                            <use fill="url(#cluster-gradient)" xlink:href="#cluster-badge" />\n                            <g transform="translate(2 2)">\n                                <g stroke="var(--brown-primary)" stroke-width="1.3">\n                                    <g transform="translate(6 24)">\n                                        <circle cx="4.752" cy="2.64" r="2.64"/>\n                                        <path d="M9.504 11.088a4.752 4.752 0 0 0-9.504 0c0 .176 9.504 0 9.504 0z"/>\n                                    </g>\n                                </g>\n                                <g stroke="var(--brown-primary)" stroke-width="1.3">\n                                    <g transform="translate(12 24)">\n                                        <circle cx="4.752" cy="2.64" r="2.64"/>\n                                        <path d="M9.504 11.088a4.752 4.752 0 0 0-9.504 0c0 .176 9.504 0 9.504 0z"/>\n                                    </g>\n                                </g>\n                                <g stroke="var(--brown-primary)" stroke-width="1.3">\n                                    <g transform="translate(18 24)">\n                                        <circle cx="4.752" cy="2.64" r="2.64"/>\n                                        <path d="M9.504 11.088a4.752 4.752 0 0 0-9.504 0c0 .176 9.504 0 9.504 0z"/>\n                                    </g>\n                                </g>\n                            </g>\n                            <text x="18.5" y="17" fill="var(--white-hex)" font-family="Roboto Slab" font-size="9" text-anchor="middle">\n                                '.concat(t,"\n                            </text>\n                        </g>\n                    </svg>\n                </div>")}}},f=Object(o.a)(d,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("common-map",{attrs:{"scroll-wheel-zoom":t.scrollWheelZoom,"zoom-position":t.zoomPosition},scopedSlots:t._u([{key:"icons",fn:function(){return[r("div",{domProps:{innerHTML:t._s(t.generateClusterIcon(0))}}),t._v(" "),r("discover-near-pin",{attrs:{user:{}}})]},proxy:!0}])},[t._v(" "),t.userLocation?r("l-marker",{attrs:{"lat-lng":t.userLocation}},[r("l-icon",[r("div",{staticClass:"h-40 w-40 rounded-half shadow-avatar relative z-above"},[r("shape-map-location",{staticClass:"w-full h-full"}),t._v(" "),r("div",{staticClass:"absolute z-below top-0 left-0 pointer-events-none h-full w-full bg-pink-primary rounded-half bg-pink-primary animation-radar animation-2s"})],1)])],1):t._e(),t._v(" "),r("l-marker-cluster",{ref:"cluster",attrs:{options:t.clusterOptions}},t._l(t.items,(function(e){return r("l-marker",{key:e.id,attrs:{"lat-lng":[e.visible_location.latitude,e.visible_location.longitude]}},[r("l-icon",{attrs:{"icon-size":[0,0],"icon-anchor":[0,0]}},[r("nuxt-link",{staticClass:"absolute w-45 bottom-0 transform -translate-x-half",attrs:{to:t.$link.showUser(e)}},[r("discover-near-pin",{attrs:{user:e}})],1)],1)],1)})),1)],1)}),[],!1,null,null,null);e.a=f.exports},528:function(t,e,r){"use strict";r.r(e);r(10);var o=r(5),n=r(397),l=r(432),c=r(442),m={scrollToTop:!0,components:{CommonMapPage:l.a,DiscoverNearMap:c.a},asyncData:function(t){return Object(o.a)(regeneratorRuntime.mark((function e(){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.$axios,e.next=3,n.a.getNearby(r);case 3:return o=e.sent,e.abrupt("return",{users:o});case 5:case"end":return e.stop()}}),e)})))()},head:function(){return{title:this.$t("discover.submenu.nomadi_near_me")}}},d=r(0),component=Object(d.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("common-map-page",{staticClass:"-mt-65 md:-mt-70",scopedSlots:t._u([{key:"map",fn:function(){return[r("discover-near-map",{attrs:{items:t.users}})]},proxy:!0}])})}),[],!1,null,null,null);e.default=component.exports}}]);